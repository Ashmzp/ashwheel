-- Correct Security Fix Script with Exact Function Signatures
-- Ye script exact parameters ke saath functions ko fix karega

ALTER FUNCTION public.check_and_update_expired_access() SET search_path = '';
ALTER FUNCTION public.generate_and_increment_invoice_no(p_user_id uuid, p_invoice_type text, p_invoice_date date) SET search_path = '';
ALTER FUNCTION public.generate_and_increment_job_card_no(p_user_id uuid, p_invoice_date date, p_customer_id uuid) SET search_path = '';
ALTER FUNCTION public.generate_invoice_no(customer_type text, inv_date date) SET search_path = '';
ALTER FUNCTION public.get_all_users_with_session_count() SET search_path = '';
ALTER FUNCTION public.get_booking_summary(p_start_date date, p_end_date date) SET search_path = '';
ALTER FUNCTION public.get_dashboard_stats(p_user_id uuid, p_start_date date, p_end_date date, p_party_names text[]) SET search_path = '';
ALTER FUNCTION public.get_financial_year(p_date date) SET search_path = '';
ALTER FUNCTION public.get_follow_ups_v2(p_start_date date, p_end_date date, p_search_term text) SET search_path = '';
ALTER FUNCTION public.get_follow_ups_v3(p_start_date date, p_end_date date, p_search_term text) SET search_path = '';
ALTER FUNCTION public.get_invoice_summary(p_user_id uuid, p_start_date date, p_end_date date) SET search_path = '';
ALTER FUNCTION public.get_invoice_summary_v2(p_user_id uuid, p_start_date date, p_end_date date) SET search_path = '';
ALTER FUNCTION public.get_next_invoice_number_v2(p_user_id uuid, p_prefix text, p_fy_short text) SET search_path = '';
ALTER FUNCTION public.get_next_job_card_invoice_no_v2(p_user_id uuid, p_invoice_date date) SET search_path = '';
ALTER FUNCTION public.get_party_ledger(p_customer_id uuid) SET search_path = '';
ALTER FUNCTION public.get_party_ledger_v2(p_customer_id uuid, p_start_date date, p_end_date date) SET search_path = '';
ALTER FUNCTION public.get_party_sale_summary(p_start_date date, p_end_date date) SET search_path = '';
ALTER FUNCTION public.get_party_vehicle_invoice_summary(p_start_date date, p_end_date date, p_customer_type text) SET search_path = '';
ALTER FUNCTION public.get_party_wise_sale_report(p_start_date date, p_end_date date) SET search_path = '';
ALTER FUNCTION public.get_party_wise_sale_report_v2(p_start_date date, p_end_date date) SET search_path = '';
ALTER FUNCTION public.get_sales_by_salesperson(p_start_date date, p_end_date date) SET search_path = '';
ALTER FUNCTION public.get_user_role() SET search_path = '';
ALTER FUNCTION public.get_vehicle_invoices_report(p_start_date date, p_end_date date) SET search_path = '';
ALTER FUNCTION public.get_vehicle_invoices_report(p_start_date date, p_end_date date, p_search_term text) SET search_path = '';
ALTER FUNCTION public.get_vehicle_invoices_report_v2(p_start_date date, p_end_date date, p_search_term text) SET search_path = '';
ALTER FUNCTION public.get_vehicle_invoices_report_v3(p_start_date date, p_end_date date, p_search_term text) SET search_path = '';
ALTER FUNCTION public.get_vehicle_invoices_report_v3(p_start_date date, p_end_date date, p_search_term text, p_page_size integer, p_page_number integer) SET search_path = '';
ALTER FUNCTION public.get_vehicle_invoices_report_v4(p_start_date date, p_end_date date, p_search_term text, p_page_size integer, p_page_number integer) SET search_path = '';
ALTER FUNCTION public.handle_new_user_default_role() SET search_path = '';
ALTER FUNCTION public.handle_stock_deletion_on_sale() SET search_path = '';
ALTER FUNCTION public.handle_updated_at() SET search_path = '';
ALTER FUNCTION public.is_premium_tools_admin(user_email text) SET search_path = '';
ALTER FUNCTION public.manage_wp_return(p_action text, p_payload jsonb) SET search_path = '';
ALTER FUNCTION public.manage_ws_return(p_action text, p_payload jsonb) SET search_path = '';
ALTER FUNCTION public.normalize_access_keys() SET search_path = '';
ALTER FUNCTION public.record_invoice_gap() SET search_path = '';
ALTER FUNCTION public.save_job_card_and_update_inventory(p_job_card_data jsonb, p_is_new boolean, p_original_job_card jsonb) SET search_path = '';
ALTER FUNCTION public.search_vehicle_invoices(p_user_id uuid, p_search_term text, p_start_date date, p_end_date date, p_page_size integer, p_page_number integer) SET search_path = '';
ALTER FUNCTION public.search_vehicle_invoices_v2(p_user_id uuid, p_search_term text, p_start_date date, p_end_date date, p_page_size integer, p_page_number integer) SET search_path = '';
ALTER FUNCTION public.search_vehicle_invoices_v3(p_user_id uuid, p_search_term text, p_start_date date, p_end_date date, p_page_size integer, p_page_number integer) SET search_path = '';
ALTER FUNCTION public.search_vehicle_invoices_v4(p_user_id uuid, p_search_term text, p_start_date date, p_end_date date, p_page_size integer, p_page_number integer) SET search_path = '';
ALTER FUNCTION public.search_vehicle_invoices_v5(p_user_id uuid, p_search_term text, p_start_date date, p_end_date date, p_page_size integer, p_page_number integer) SET search_path = '';
ALTER FUNCTION public.sync_sold_stock() SET search_path = '';
ALTER FUNCTION public.track_job_card_history(p_search_term text) SET search_path = '';
ALTER FUNCTION public.track_vehicle_history(p_search_term text) SET search_path = '';
ALTER FUNCTION public.track_vehicle_history_v2(p_search_term text) SET search_path = '';
ALTER FUNCTION public.track_vehicle_history_v3(p_search_term text) SET search_path = '';
ALTER FUNCTION public.track_vehicle_history_v4(p_search_term text) SET search_path = '';
ALTER FUNCTION public.track_vehicle_history_v5(p_search_term text) SET search_path = '';
ALTER FUNCTION public.track_vehicle_history_v6(p_search_term text) SET search_path = '';
ALTER FUNCTION public.track_vehicle_history_v7(p_search_term text) SET search_path = '';
ALTER FUNCTION public.track_vehicle_history_v8(p_search_term text) SET search_path = '';
ALTER FUNCTION public.track_vehicle_history_v9(p_search_term text) SET search_path = '';
ALTER FUNCTION public.track_vehicle_history_v10(p_search_term text) SET search_path = '';
ALTER FUNCTION public.track_vehicle_history_v11(p_search_term text) SET search_path = '';
ALTER FUNCTION public.track_vehicle_history_v12(p_search_term text) SET search_path = '';
ALTER FUNCTION public.track_vehicle_history_v13(p_search_term text) SET search_path = '';
ALTER FUNCTION public.update_inventory_from_purchases() SET search_path = '';
ALTER FUNCTION public.update_inventory_item_quantity(p_part_no text, p_quantity_change numeric, p_user_id uuid, p_item_data jsonb) SET search_path = '';
ALTER FUNCTION public.upsert_and_update_inventory(p_items jsonb, p_user_id uuid) SET search_path = '';